{% extends 'master/base.html' %}

{% block content %}

<div aria-label="breadcrumb">
  <h6 class="font-weight-bolder mb-0 fs-2">Course-Wise Report</h6>
  <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
      
      <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark"
          href="javascript:;"><i class="bi bi-house-fill"></i></a>
      </li>
      
      <li class="breadcrumb-item text-sm text-dark active" aria-current="page"><a href="{% url 'dashboard' %}"  class="text-decoration-none text-dark">Dashboard</a></li>
      <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Reports</li>

      <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Course-Wise Report</li>

  </ol>
</div>
<div class="container border mt-5 p-3 w-100" style="box-shadow: 1px 1px 6px;">


<!-- <div class="float-end pt-3">
  <a href="" class=" btn btn-success">Complete </a>
  <a href="" class=" btn btn-danger">Pending</a>
</div> -->
<div class="btn-group pt-3" role="group" aria-label="Basic outlined example">
  <a href="{% url 'course_report_to_csv' %}"><button type="button" class="btn btn-outline-primary">CSV</button></a>
  <a href="{% url 'course_report_to_pdf' %}"><button type="button" class="btn btn-outline-primary">PDF</button></a>
  <a href=""><button type="button" onclick="printTable('admits_table')" value="Print a table!"  class="btn btn-outline-primary">Print</button></a>

  <div class="container-fluid">
    <div class="d-flex">
      <input class="form-control me-2 " type="search" placeholder="Search" aria-label="Search">
      <!-- <button class="btn btn-outline-success" type="submit">Search</button> -->
    </div>
  </div>

</div>


<div class="float-end pt-3">
  <button onclick="filterAdmits('all')" class="btn btn-info text-light">All</button>
  <button onclick="filterAdmits('complete')" class="btn btn-success">Complete</button>
  <button onclick="filterAdmits('pending')" class="btn btn-danger">Pending</button>

</div>

<div class="container pt-5">
  <!-- <h1 class="text-center">Course-Wise Report</h1> -->
  
  <table class="table table-striped" id="admits_table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Name</th>
        <th scope="col">Course</th>
        <th scope="col">Balance Fees</th>
      </tr>
    </thead>
    <tbody>
      {% for a in admit %}
      <tr>
        <th scope="row">{{forloop.counter}}</th>
        <td>{{a.stu_name}}</td>
        <td>{{a.course.course}}</td>
        <td>{{a.balance_fees}}</td>
      </tr>
      {% endfor %}
      {% for a in admits %}
      <tr>
        <th scope="row">{{forloop.counter}}</th>
        <td>{{a.stu_name}}</td>
        <td>{{a.course.course}}</td>
        <td>{{a.balance_fees}}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>


</div>
</div>
<script>
  function filterAdmits(balanceStatus) {
    fetch(`/balance_status/?balance_status=${balanceStatus}`)
      .then(response => response.text())
      .then(html => {
        const parser = new DOMParser();
        const newDocument = parser.parseFromString(html, 'text/html');
        const newTable = newDocument.querySelector('#admits_table');
        document.querySelector('#admits_table').parentNode.replaceChild(newTable, document.querySelector('#admits_table'));
      })
      .catch(error => console.error('Error fetching admits:', error));
  }
   
//script for print table function
function printTable(tableId) {
  var printContents = document.getElementById(tableId).outerHTML;
  var originalContents = document.body.innerHTML;

  var popupWin = window.open('', '_blank', 'width=600,height=600');
  popupWin.document.open();
  popupWin.document.write('<html><head><title>Print</title><style>@media print {body {visibility: hidden;} table {visibility: visible;} .hide {visibility: hidden;}}</style></head><body onload="window.print()"><table>' + printContents + '</table></body></html>');
  popupWin.document.close();

  // Restore the original contents
  document.body.innerHTML = originalContents;
}

</script>
{% endblock content %}